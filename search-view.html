<!DOCTYPE html>
<html lang="en">
<head>
    <title>Search Results - RentAll</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="styles.css">
    <style>
        .search-map-container {
            display: flex;
            gap: 2rem;
            margin-top: 2rem;
        }
        .results-grid {
            flex: 2;
        }
        .map-section {
            flex: 1;
            min-width: 320px;
            max-width: 400px;
        }
        .map-embed {
            width: 100%;
            height: 400px;
            border-radius: 12px;
            border: 1px solid #eee;
        }
        .featured-card {
            transition: transform 0.2s ease-in-out;
            border: 2px solid transparent;
        }
        .featured-card:hover {
            transform: translateY(-5px);
            border-color: #007bff;
            box-shadow: 0 4px 15px rgba(0, 123, 255, 0.2);
        }
        .carousel-control-prev,
        .carousel-control-next {
            width: 40px;
            height: 40px;
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
            top: 50%;
            transform: translateY(-50%);
        }
        .carousel-control-prev {
            left: -20px;
        }
        .carousel-control-next {
            right: -20px;
        }
        @media (max-width: 991px) {
            .search-map-container {
                flex-direction: column;
            }
            .map-section {
                max-width: 100%;
                margin-top: 2rem;
            }
            .carousel-control-prev,
            .carousel-control-next {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation Bar (copied from index.html) -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm">
        <div class="container">
            <a class="navbar-brand fw-bold" href="index.html">
                <i class="bi bi-box-seam"></i> RentAll
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavDropdown">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link text-dark" href="index.html">Home</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle text-dark" href="categories.html" id="navbarDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Categories
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="categories.html">All Categories</a></li>
                            <li><a class="dropdown-item" href="search-view.html?category=tools">Tools & Equipment</a></li>
                            <li><a class="dropdown-item" href="search-view.html?category=sports">Sports & Outdoors</a></li>
                            <li><a class="dropdown-item" href="search-view.html?category=electronics">Electronics</a></li>
                            <li><a class="dropdown-item" href="search-view.html?category=entertainment">Entertainment</a></li>
                            <li><a class="dropdown-item" href="search-view.html?category=home">Home & Garden</a></li>
                            <li><a class="dropdown-item" href="search-view.html?category=vehicles">Vehicles & Transportation</a></li>
                            <li><a class="dropdown-item" href="search-view.html?category=fashion">Fashion & Accessories</a></li>
                            <li><a class="dropdown-item" href="search-view.html?category=baby">Baby & Kids</a></li>
                            <li><a class="dropdown-item" href="search-view.html?category=business">Business & Office</a></li>
                            <li><a class="dropdown-item" href="search-view.html?category=health">Health & Fitness</a></li>
                            <li><a class="dropdown-item" href="search-view.html?category=photography">Photography & Video</a></li>
                            <li><a class="dropdown-item" href="search-view.html?category=music">Music & Audio</a></li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-dark" href="#">About Us</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-dark" href="contact.html">Contact Us</a>
                    </li>
                </ul>
                <form class="d-flex ms-3 me-3 navbar-search" role="search" style="max-width: 300px; width: 100%;">
                    <input class="form-control me-2" type="search" placeholder="Search rentals..." aria-label="Search">
                    <button class="btn btn-outline-light" type="submit"><i class="bi bi-search"></i></button>
                </form>
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <button class="btn auth-button me-2" data-bs-toggle="modal" data-bs-target="#createListingModal">
                            <i class="bi bi-plus-circle"></i> Create Listing
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="btn auth-button me-2" data-bs-toggle="modal" data-bs-target="#loginModal">
                            Sign In
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="btn auth-button" data-bs-toggle="modal" data-bs-target="#registerModal">
                            Register
                        </button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="hero-decoration"></div>
        <div class="container">
            <div class="hero-content text-center">
                <h1 class="hero-title" id="category-title">All Categories</h1>
                <p class="hero-subtitle">Discover amazing rentals in your community</p>
                
                <!-- Search Bar -->
                <div class="search-container d-flex align-items-center">
                    <i class="bi bi-search ms-3 text-muted"></i>
                    <input type="text" class="search-input" placeholder="What would you like to rent?">
                    <button class="search-button">Search</button>
                </div>
                
                <!-- Location Picker -->
                <div class="mt-3">
                    <a href="#" class="location-picker">
                        <i class="bi bi-geo-alt"></i>
                        Near Richmond, BC
                        <span class="text-secondary">(change)</span>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Search Bar and Filters -->
    <div class="container mt-4">
        <div class="d-flex flex-wrap align-items-center gap-2 mb-3">
            <div class="flex-grow-1">
                <div class="input-group">
                    <span class="input-group-text bg-white"><i class="bi bi-search"></i></span>
                    <input type="text" class="form-control" placeholder="Search an item by name or keyword...">
                </div>
            </div>
            <button class="btn btn-outline-secondary d-flex align-items-center" type="button" data-bs-toggle="modal" data-bs-target="#filterModal">
                <i class="bi bi-sliders me-1"></i> Filters
            </button>
        </div>
        <div class="mb-2 text-muted small">1411 Rental opportunities in the <b>Richmond</b> area</div>
    </div>

    <!-- Results and Map -->
    <div class="container search-map-container">
        <div class="results-grid">
            <!-- Subcategory Buttons (injected by JS) -->
            <div id="subcategory-row" class="mb-3"></div>
            
            <!-- Featured Items Slider -->
            <div class="mb-4">
                <h5 class="fw-bold mb-3">
                    <i class="bi bi-star-fill text-warning me-2"></i>Featured Items
                </h5>
                <div id="featured-carousel" class="carousel slide" data-bs-ride="carousel">
                    <div class="carousel-inner">
                        <!-- Featured items will be injected here by JavaScript -->
                    </div>
                    <button class="carousel-control-prev" type="button" data-bs-target="#featured-carousel" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#featured-carousel" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                </div>
            </div>
            
            <!-- Results Header -->
            <div id="results-header" class="mb-3 fw-bold"></div>
            
            <!-- Dynamic Posts Container -->
            <div id="posts-container" class="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-4">
                <!-- Posts will be dynamically generated here -->
            </div>
        </div>
        <!-- Map Section -->
        <div class="map-section">
            <div class="mb-2 fw-bold"><i class="bi bi-geo-alt"></i> Map of Listings</div>
            <iframe class="map-embed" src="https://www.openstreetmap.org/export/embed.html?bbox=-75.9%2C45.2%2C-75.5%2C45.5&amp;layer=mapnik" allowfullscreen="" loading="lazy"></iframe>
        </div>
    </div>

    <!-- Filter Modal -->
    <div class="modal fade" id="filterModal" tabindex="-1" aria-labelledby="filterModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="filterModalLabel">
                        <i class="bi bi-sliders me-2"></i>Advanced Filters
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="filterForm">
                        <!-- Category & Subcategory Section -->
                        <div class="mb-4">
                            <h6 class="fw-bold mb-3">Category & Subcategory</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <label class="form-label">Main Category</label>
                                    <select class="form-select" id="mainCategory">
                                        <option value="">All Categories</option>
                                        <option value="tools">Tools & Equipment</option>
                                        <option value="sports">Sports & Outdoors</option>
                                        <option value="electronics">Electronics</option>
                                        <option value="entertainment">Entertainment</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Subcategory</label>
                                    <select class="form-select" id="subcategory">
                                        <option value="">All Subcategories</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Price Range Section -->
                        <div class="mb-4">
                            <h6 class="fw-bold mb-3">Price Range</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <label class="form-label">Minimum Price ($/day)</label>
                                    <input type="number" class="form-control" id="minPrice" placeholder="0" min="0">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Maximum Price ($/day)</label>
                                    <input type="number" class="form-control" id="maxPrice" placeholder="1000" min="0">
                                </div>
                            </div>
                        </div>

                        <!-- Location & Distance Section -->
                        <div class="mb-4">
                            <h6 class="fw-bold mb-3">Location & Distance</h6>
                            <div class="row">
                                <div class="col-md-8">
                                    <label class="form-label">Location</label>
                                    <input type="text" class="form-control" id="location" placeholder="Enter city or postal code">
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">Distance (km)</label>
                                    <select class="form-select" id="distance">
                                        <option value="5">5 km</option>
                                        <option value="10" selected>10 km</option>
                                        <option value="25">25 km</option>
                                        <option value="50">50 km</option>
                                        <option value="100">100 km</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Availability Section -->
                        <div class="mb-4">
                            <h6 class="fw-bold mb-3">Availability</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <label class="form-label">Start Date</label>
                                    <input type="date" class="form-control" id="startDate">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">End Date</label>
                                    <input type="date" class="form-control" id="endDate">
                                </div>
                            </div>
                        </div>

                        <!-- Owner Rating Section -->
                        <div class="mb-4">
                            <h6 class="fw-bold mb-3">Owner Rating</h6>
                            <div class="d-flex gap-2">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="rating" id="ratingAny" value="" checked>
                                    <label class="form-check-label" for="ratingAny">Any Rating</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="rating" id="rating4Plus" value="4">
                                    <label class="form-check-label" for="rating4Plus">4+ Stars</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="rating" id="rating5" value="5">
                                    <label class="form-check-label" for="rating5">5 Stars Only</label>
                                </div>
                            </div>
                        </div>

                        <!-- Sort Options Section -->
                        <div class="mb-4">
                            <h6 class="fw-bold mb-3">Sort By</h6>
                            <select class="form-select" id="sortBy">
                                <option value="relevance" selected>Relevance</option>
                                <option value="price-low">Price: Low to High</option>
                                <option value="price-high">Price: High to Low</option>
                                <option value="distance">Distance</option>
                                <option value="rating">Highest Rated</option>
                                <option value="newest">Newest First</option>
                            </select>
                        </div>

                        <!-- Additional Filters Section -->
                        <div class="mb-4">
                            <h6 class="fw-bold mb-3">Additional Filters</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="verifiedOwners">
                                        <label class="form-check-label" for="verifiedOwners">Verified Owners Only</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="instantBooking">
                                        <label class="form-check-label" for="instantBooking">Instant Booking Available</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="freeDelivery">
                                        <label class="form-check-label" for="freeDelivery">Free Delivery</label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="weekendOnly">
                                        <label class="form-check-label" for="weekendOnly">Weekend Rentals Only</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="longTerm">
                                        <label class="form-check-label" for="longTerm">Long-term Rentals</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="negotiable">
                                        <label class="form-check-label" for="negotiable">Price Negotiable</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-outline-secondary" onclick="clearFilters()">Clear All</button>
                    <button type="button" class="btn btn-primary" onclick="applyFilters()">Apply Filters</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="location-service.js"></script>
    <script>
    // --- Subcategory and Category Logic ---
    (function() {
        // Category to subcategories mapping
        const subcategories = {
            tools: ['Power Tools', 'Gardening', 'Construction', 'Hand Tools', 'Automotive', 'Cleaning', 'Painting', 'Plumbing'],
            sports: ['Bikes', 'Camping', 'Fitness', 'Water Sports', 'Winter Sports', 'Team Sports', 'Hiking', 'Yoga'],
            electronics: ['Cameras', 'Audio', 'Gadgets', 'Computers', 'Gaming', 'Mobile Devices', 'Home Theater', 'Smart Home'],
            entertainment: ['Games', 'Movies', 'Party', 'Musical Instruments', 'Board Games', 'VR Equipment', 'Karaoke', 'DJ Equipment'],
            home: ['Furniture', 'Appliances', 'Decor', 'Garden Tools', 'Kitchen Equipment', 'Cleaning Supplies', 'Storage', 'Lighting'],
            vehicles: ['Cars', 'Trucks', 'Motorcycles', 'Scooters', 'Trailers', 'Bikes', 'Boats', 'Recreational Vehicles'],
            fashion: ['Formal Wear', 'Costumes', 'Jewelry', 'Handbags', 'Accessories', 'Shoes', 'Watches', 'Sunglasses'],
            baby: ['Strollers', 'Car Seats', 'Baby Gear', 'Toys', 'Educational Materials', 'Nursery Equipment', 'Safety Items', 'Feeding Supplies'],
            business: ['Office Equipment', 'Presentation Tools', 'Meeting Furniture', 'Business Supplies', 'Computers', 'Printers', 'Conference Equipment', 'Office Decor'],
            health: ['Exercise Equipment', 'Yoga Mats', 'Fitness Trackers', 'Massage Chairs', 'Wellness Products', 'Medical Equipment', 'Rehabilitation', 'Sports Medicine'],
            photography: ['Professional Cameras', 'Lenses', 'Lighting Equipment', 'Tripods', 'Video Production', 'Studio Equipment', 'Accessories', 'Editing Tools'],
            music: ['Musical Instruments', 'Sound Systems', 'Microphones', 'Amplifiers', 'Recording Equipment', 'DJ Equipment', 'Studio Gear', 'Accessories']
        };
        // Get query param
        function getQueryParam(name) {
            const url = new URL(window.location.href);
            return url.searchParams.get(name);
        }
        // Capitalize
        function cap(str) { return str.charAt(0).toUpperCase() + str.slice(1); }
        // Render subcategory buttons
        function renderSubcategories(category, selectedSub) {
            const row = document.getElementById('subcategory-row');
            row.innerHTML = '';
            if (!subcategories[category]) return;
            subcategories[category].forEach(sub => {
                const btn = document.createElement('button');
                btn.className = 'btn btn-outline-primary btn-sm me-2 mb-2' + (selectedSub === sub ? ' active' : '');
                btn.textContent = sub;
                btn.onclick = function() {
                    renderSubcategories(category, sub);
                    renderHeader(category, sub);
                    renderSamplePosts(category, sub);
                };
                row.appendChild(btn);
            });
        }
        // Render header
        function renderHeader(category, sub) {
            const header = document.getElementById('results-header');
            let text = '';
            if (category) {
                text = cap(category.replace(/_/g, ' '));
                if (sub) text += ' / ' + sub;
                text = 'Showing results for: <span class="text-primary">' + text + '</span>';
            } else {
                text = 'Showing all results';
            }
            header.innerHTML = text;
        }
        
        // Update hero title
        function updateHeroTitle(category) {
            const heroTitle = document.getElementById('category-title');
            if (category) {
                const categoryNames = {
                    'tools': 'Tools & Equipment',
                    'sports': 'Sports & Outdoors', 
                    'electronics': 'Electronics',
                    'entertainment': 'Entertainment',
                    'home': 'Home & Garden',
                    'vehicles': 'Vehicles & Transportation',
                    'fashion': 'Fashion & Accessories',
                    'baby': 'Baby & Kids',
                    'business': 'Business & Office',
                    'health': 'Health & Fitness',
                    'photography': 'Photography & Video',
                    'music': 'Music & Audio'
                };
                heroTitle.textContent = categoryNames[category] || cap(category.replace(/_/g, ' '));
            } else {
                heroTitle.textContent = 'All Categories';
            }
        }
        // Featured items data for each category
        const featuredItems = {
            tools: [
                { title: 'Professional Drill Set', price: 25, owner: 'Mike T', image: 'https://images.unsplash.com/photo-1581147036324-c1c89c2c8b5c?auto=format&fit=crop&w=400&q=80', rating: 4.8, featured: true },
                { title: 'Garden Power Tools Kit', price: 30, owner: 'Sarah L', image: 'https://images.unsplash.com/photo-1586023492125-27b2c045efd7?auto=format&fit=crop&w=400&q=80', rating: 4.9, featured: true },
                { title: 'Complete Hand Tool Set', price: 15, owner: 'John D', image: 'https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?auto=format&fit=crop&w=400&q=80', rating: 4.7, featured: true }
            ],
            sports: [
                { title: 'Mountain Bike Premium', price: 20, owner: 'Emma R', image: 'https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?auto=format&fit=crop&w=400&q=80', rating: 4.9, featured: true },
                { title: 'Camping Tent 4-Person', price: 35, owner: 'David K', image: 'https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=400&q=80', rating: 4.8, featured: true },
                { title: 'Yoga Equipment Set', price: 12, owner: 'Lisa M', image: 'https://images.unsplash.com/photo-1544367567-0f2fcb009e0b?auto=format&fit=crop&w=400&q=80', rating: 4.6, featured: true }
            ],
            electronics: [
                { title: 'Professional Camera Kit', price: 45, owner: 'Jane D', image: 'https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80', rating: 4.9, featured: true },
                { title: '4K Smart Projector', price: 60, owner: 'Ted S', image: 'https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=crop&w=400&q=80', rating: 4.8, featured: true },
                { title: 'Gaming Console Bundle', price: 25, owner: 'Mark L', image: 'https://images.unsplash.com/photo-1498049794561-7780e7231661?auto=format&fit=crop&w=400&q=80', rating: 4.7, featured: true }
            ],
            entertainment: [
                { title: 'Board Game Collection', price: 8, owner: 'Chris T', image: 'https://images.unsplash.com/photo-1511512578047-dfb367046420?auto=format&fit=crop&w=400&q=80', rating: 4.6, featured: true },
                { title: 'Karaoke Machine Pro', price: 22, owner: 'Anna M', image: 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?auto=format&fit=crop&w=400&q=80', rating: 4.8, featured: true },
                { title: 'VR Gaming Headset', price: 35, owner: 'Paul R', image: 'https://images.unsplash.com/photo-1519121789249-bc1c1f1c7c93?auto=format&fit=crop&w=400&q=80', rating: 4.9, featured: true }
            ],
            home: [
                { title: 'Modern Furniture Set', price: 45, owner: 'Maria G', image: 'https://images.unsplash.com/photo-1586023492125-27b2c045efd7?auto=format&fit=crop&w=400&q=80', rating: 4.8, featured: true },
                { title: 'Kitchen Appliance Bundle', price: 30, owner: 'Kevin H', image: 'https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?auto=format&fit=crop&w=400&q=80', rating: 4.7, featured: true },
                { title: 'Garden Tools Collection', price: 18, owner: 'Laura B', image: 'https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=400&q=80', rating: 4.6, featured: true }
            ],
            vehicles: [
                { title: 'Compact Car Rental', price: 80, owner: 'Auto Rentals', image: 'https://images.unsplash.com/photo-1549317661-bd32c8ce0db2?auto=format&fit=crop&w=400&q=80', rating: 4.9, featured: true },
                { title: 'Motorcycle Sport', price: 45, owner: 'Bike Rentals', image: 'https://images.unsplash.com/photo-1558981806-ec527fa84a39?auto=format&fit=crop&w=400&q=80', rating: 4.8, featured: true },
                { title: 'Electric Scooter', price: 15, owner: 'Scooter Rent', image: 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?auto=format&fit=crop&w=400&q=80', rating: 4.7, featured: true }
            ],
            fashion: [
                { title: 'Formal Suit Collection', price: 35, owner: 'Fashion Rent', image: 'https://images.unsplash.com/photo-1445205170230-053b83016050?auto=format&fit=crop&w=400&q=80', rating: 4.8, featured: true },
                { title: 'Wedding Dress Set', price: 120, owner: 'Bridal Rentals', image: 'https://images.unsplash.com/photo-1515372039744-b8f02a3ae446?auto=format&fit=crop&w=400&q=80', rating: 4.9, featured: true },
                { title: 'Jewelry Collection', price: 25, owner: 'Luxury Rent', image: 'https://images.unsplash.com/photo-1515562141207-7a88fb7ce338?auto=format&fit=crop&w=400&q=80', rating: 4.7, featured: true }
            ],
            baby: [
                { title: 'Baby Stroller Premium', price: 20, owner: 'Baby Gear', image: 'https://images.unsplash.com/photo-1544126592-807ade215a0b?auto=format&fit=crop&w=400&q=80', rating: 4.8, featured: true },
                { title: 'Car Seat Safety', price: 15, owner: 'Safety First', image: 'https://images.unsplash.com/photo-1544126592-807ade215a0b?auto=format&fit=crop&w=400&q=80', rating: 4.9, featured: true },
                { title: 'Educational Toys Set', price: 12, owner: 'Learning Toys', image: 'https://images.unsplash.com/photo-1544126592-807ade215a0b?auto=format&fit=crop&w=400&q=80', rating: 4.6, featured: true }
            ],
            business: [
                { title: 'Conference Room Setup', price: 100, owner: 'Office Rentals', image: 'https://images.unsplash.com/photo-1497366216548-37526070297c?auto=format&fit=crop&w=400&q=80', rating: 4.9, featured: true },
                { title: 'Presentation Equipment', price: 45, owner: 'Business Tools', image: 'https://images.unsplash.com/photo-1497366216548-37526070297c?auto=format&fit=crop&w=400&q=80', rating: 4.8, featured: true },
                { title: 'Office Furniture Set', price: 60, owner: 'Furniture Co', image: 'https://images.unsplash.com/photo-1497366216548-37526070297c?auto=format&fit=crop&w=400&q=80', rating: 4.7, featured: true }
            ],
            health: [
                { title: 'Treadmill Professional', price: 40, owner: 'Fitness Rent', image: 'https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?auto=format&fit=crop&w=400&q=80', rating: 4.8, featured: true },
                { title: 'Yoga Equipment Set', price: 15, owner: 'Wellness Co', image: 'https://images.unsplash.com/photo-1544367567-0f2fcb009e0b?auto=format&fit=crop&w=400&q=80', rating: 4.7, featured: true },
                { title: 'Massage Chair', price: 50, owner: 'Relax Rent', image: 'https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?auto=format&fit=crop&w=400&q=80', rating: 4.9, featured: true }
            ],
            photography: [
                { title: 'DSLR Camera Kit', price: 55, owner: 'Photo Rent', image: 'https://images.unsplash.com/photo-1516035069371-29a1b244cc32?auto=format&fit=crop&w=400&q=80', rating: 4.9, featured: true },
                { title: 'Professional Lighting', price: 40, owner: 'Studio Gear', image: 'https://images.unsplash.com/photo-1516035069371-29a1b244cc32?auto=format&fit=crop&w=400&q=80', rating: 4.8, featured: true },
                { title: 'Video Production Kit', price: 75, owner: 'Video Rent', image: 'https://images.unsplash.com/photo-1516035069371-29a1b244cc32?auto=format&fit=crop&w=400&q=80', rating: 4.7, featured: true }
            ],
            music: [
                { title: 'Guitar Collection', price: 25, owner: 'Music Rent', image: 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?auto=format&fit=crop&w=400&q=80', rating: 4.8, featured: true },
                { title: 'Sound System Pro', price: 60, owner: 'Audio Rent', image: 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?auto=format&fit=crop&w=400&q=80', rating: 4.9, featured: true },
                { title: 'DJ Equipment Set', price: 80, owner: 'DJ Rentals', image: 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?auto=format&fit=crop&w=400&q=80', rating: 4.7, featured: true }
            ]
        };

        // Sample data for each category and subcategory
        const samplePosts = {
            tools: {
                'Power Tools': [
                    { title: 'Professional Drill Set', price: 25, owner: 'Mike T', image: 'https://images.unsplash.com/photo-1581147036324-c1c89c2c8b5c?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Circular Saw Pro', price: 30, owner: 'Sarah L', image: 'https://images.unsplash.com/photo-1586023492125-27b2c045efd7?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Impact Driver Kit', price: 20, owner: 'John D', image: 'https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Angle Grinder', price: 15, owner: 'Alex P', image: 'https://images.unsplash.com/photo-1581147036324-c1c89c2c8b5c?auto=format&fit=crop&w=400&q=80' }
                ],
                'Gardening': [
                    { title: 'Garden Power Tools Kit', price: 30, owner: 'Sarah L', image: 'https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Lawn Mower Electric', price: 25, owner: 'Mike T', image: 'https://images.unsplash.com/photo-1586023492125-27b2c045efd7?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Hedge Trimmer', price: 18, owner: 'John D', image: 'https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Leaf Blower', price: 12, owner: 'Alex P', image: 'https://images.unsplash.com/photo-1581147036324-c1c89c2c8b5c?auto=format&fit=crop&w=400&q=80' }
                ],
                'Construction': [
                    { title: 'Concrete Mixer', price: 50, owner: 'Construction Co', image: 'https://images.unsplash.com/photo-1586023492125-27b2c045efd7?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Scaffolding Set', price: 80, owner: 'Build Rent', image: 'https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Jackhammer', price: 45, owner: 'Demolition Rent', image: 'https://images.unsplash.com/photo-1581147036324-c1c89c2c8b5c?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Cement Mixer', price: 35, owner: 'Concrete Co', image: 'https://images.unsplash.com/photo-1586023492125-27b2c045efd7?auto=format&fit=crop&w=400&q=80' }
                ],
                'Hand Tools': [
                    { title: 'Complete Hand Tool Set', price: 15, owner: 'John D', image: 'https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Socket Set Professional', price: 20, owner: 'Mike T', image: 'https://images.unsplash.com/photo-1581147036324-c1c89c2c8b5c?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Wrench Collection', price: 12, owner: 'Sarah L', image: 'https://images.unsplash.com/photo-1586023492125-27b2c045efd7?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Screwdriver Set', price: 8, owner: 'Alex P', image: 'https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?auto=format&fit=crop&w=400&q=80' }
                ]
            },
            sports: {
                'Bikes': [
                    { title: 'Mountain Bike Premium', price: 20, owner: 'Emma R', image: 'https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Road Bike Pro', price: 25, owner: 'David K', image: 'https://images.unsplash.com/photo-1519681393784-d120267933ba?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Electric Bike', price: 35, owner: 'Bike Rent', image: 'https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?auto=format&fit=crop&w=400&q=80' },
                    { title: 'BMX Bike', price: 15, owner: 'Tom W', image: 'https://images.unsplash.com/photo-1519681393784-d120267933ba?auto=format&fit=crop&w=400&q=80' }
                ],
                'Camping': [
                    { title: 'Camping Tent 4-Person', price: 35, owner: 'David K', image: 'https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Sleeping Bag Set', price: 12, owner: 'Lisa M', image: 'https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Camping Stove', price: 18, owner: 'Tom W', image: 'https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Hiking Backpack', price: 10, owner: 'Emma R', image: 'https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?auto=format&fit=crop&w=400&q=80' }
                ],
                'Fitness': [
                    { title: 'Yoga Equipment Set', price: 12, owner: 'Lisa M', image: 'https://images.unsplash.com/photo-1544367567-0f2fcb009e0b?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Treadmill Professional', price: 40, owner: 'Fitness Rent', image: 'https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Weight Bench Set', price: 25, owner: 'Gym Rent', image: 'https://images.unsplash.com/photo-1544367567-0f2fcb009e0b?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Elliptical Machine', price: 30, owner: 'Health Co', image: 'https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?auto=format&fit=crop&w=400&q=80' }
                ]
            },
            electronics: {
                'Cameras': [
                    { title: 'Professional Camera Kit', price: 45, owner: 'Jane D', image: 'https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80' },
                    { title: 'GoPro Hero Action', price: 20, owner: 'Mike T', image: 'https://images.unsplash.com/photo-1517841905240-472988babdf9?auto=format&fit=crop&w=400&q=80' },
                    { title: 'DSLR Camera Kit', price: 55, owner: 'Photo Rent', image: 'https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Video Camera Pro', price: 40, owner: 'Video Rent', image: 'https://images.unsplash.com/photo-1517841905240-472988babdf9?auto=format&fit=crop&w=400&q=80' }
                ],
                'Audio': [
                    { title: 'Bluetooth Speaker Pro', price: 15, owner: 'Audio Rent', image: 'https://images.unsplash.com/photo-1519121789249-bc1c1f1c7c93?auto=format&fit=crop&w=400&q=80' },
                    { title: 'DJ Equipment Set', price: 80, owner: 'DJ Rentals', image: 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Microphone Kit', price: 25, owner: 'Studio Gear', image: 'https://images.unsplash.com/photo-1519121789249-bc1c1f1c7c93?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Sound System Pro', price: 60, owner: 'Audio Rent', image: 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?auto=format&fit=crop&w=400&q=80' }
                ],
                'Gadgets': [
                    { title: 'Gaming Console Bundle', price: 25, owner: 'Mark L', image: 'https://images.unsplash.com/photo-1498049794561-7780e7231661?auto=format&fit=crop&w=400&q=80' },
                    { title: 'VR Gaming Headset', price: 35, owner: 'Paul R', image: 'https://images.unsplash.com/photo-1519121789249-bc1c1f1c7c93?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Smart Watch', price: 18, owner: 'Tech Rent', image: 'https://images.unsplash.com/photo-1498049794561-7780e7231661?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Tablet Pro', price: 30, owner: 'Device Rent', image: 'https://images.unsplash.com/photo-1519121789249-bc1c1f1c7c93?auto=format&fit=crop&w=400&q=80' }
                ]
            },
            entertainment: {
                'Games': [
                    { title: 'Board Game Collection', price: 8, owner: 'Chris T', image: 'https://images.unsplash.com/photo-1511512578047-dfb367046420?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Video Game Console', price: 20, owner: 'Game Rent', image: 'https://images.unsplash.com/photo-1498049794561-7780e7231661?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Puzzle Collection', price: 5, owner: 'Brain Games', image: 'https://images.unsplash.com/photo-1511512578047-dfb367046420?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Card Game Set', price: 3, owner: 'Card Rent', image: 'https://images.unsplash.com/photo-1498049794561-7780e7231661?auto=format&fit=crop&w=400&q=80' }
                ],
                'Party': [
                    { title: 'Karaoke Machine Pro', price: 22, owner: 'Anna M', image: 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Party Equipment Set', price: 40, owner: 'Sophie L', image: 'https://images.unsplash.com/photo-1519121789249-bc1c1f1c7c93?auto=format&fit=crop&w=400&q=80' },
                    { title: 'DJ Equipment Set', price: 80, owner: 'DJ Rentals', image: 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Photo Booth', price: 50, owner: 'Party Pro', image: 'https://images.unsplash.com/photo-1519121789249-bc1c1f1c7c93?auto=format&fit=crop&w=400&q=80' }
                ],
                'Musical Instruments': [
                    { title: 'Guitar Collection', price: 25, owner: 'Music Rent', image: 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Piano Rental', price: 100, owner: 'Piano Co', image: 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Drum Set Pro', price: 45, owner: 'Drum Rent', image: 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Violin Rental', price: 35, owner: 'String Rent', image: 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?auto=format&fit=crop&w=400&q=80' }
                ]
            }
        };

        // Function to render featured carousel
        function renderFeaturedCarousel(category) {
            const carouselInner = document.querySelector('#featured-carousel .carousel-inner');
            if (!carouselInner || !featuredItems[category]) return;
            
            carouselInner.innerHTML = '';
            const items = featuredItems[category];
            
            // Group items into slides (3 items per slide)
            for (let i = 0; i < items.length; i += 3) {
                const slideItems = items.slice(i, i + 3);
                const isActive = i === 0 ? 'active' : '';
                
                const slideHtml = `
                    <div class="carousel-item ${isActive}">
                        <div class="row g-3">
                            ${slideItems.map(item => `
                                <div class="col-md-4">
                                    <div class="card h-100 featured-card" style="cursor: pointer;" onclick="window.location.href='product-details.html'">
                                        <div class="position-relative">
                                            <img src="${item.image}" class="card-img-top" alt="${item.title}" style="height: 200px; object-fit: cover;">
                                            <div class="position-absolute top-0 end-0 m-2">
                                                <span class="badge bg-warning text-dark">
                                                    <i class="bi bi-star-fill"></i> ${item.rating}
                                                </span>
                                            </div>
                                        </div>
                                        <div class="card-body">
                                            <h6 class="card-title">${item.title}</h6>
                                            <p class="card-text mb-1"><b>$${item.price}.00</b> <span class="text-muted">/ day</span></p>
                                            <p class="card-text small">Owner: <a href="/user/1" class="text-decoration-none text-primary">${item.owner}</a></p>
                                            <button class="btn btn-primary btn-sm w-100" onclick="event.stopPropagation();">Book Now</button>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                carouselInner.innerHTML += slideHtml;
            }
        }

        // Function to render sample posts
        function renderSamplePosts(category, subcategory = null) {
            const postsContainer = document.getElementById('posts-container');
            if (!postsContainer) return;
            
            let posts = [];
            
            if (subcategory && samplePosts[category] && samplePosts[category][subcategory]) {
                // Show posts for specific subcategory
                posts = samplePosts[category][subcategory];
            } else if (samplePosts[category]) {
                // Show all posts for category (flatten subcategories)
                Object.values(samplePosts[category]).forEach(subPosts => {
                    posts = posts.concat(subPosts);
                });
            } else {
                // Default posts if no category data
                posts = [
                    { title: 'Royale R-1000 4k Led Smart Projector', price: 60, owner: 'Ted S', image: 'https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Compact Charcoal Grill Rental', price: 50, owner: 'Ted S', image: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Professional Camera Kit', price: 25, owner: 'Jane D', image: 'https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Mountain Bike', price: 15, owner: 'Alex P', image: 'https://images.unsplash.com/photo-1519681393784-d120267933ba?auto=format&fit=crop&w=400&q=80' },
                    { title: '4-Person Camping Tent', price: 18, owner: 'Sam R', image: 'https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Electric Lawn Mower', price: 22, owner: 'Chris L', image: 'https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Bluetooth Party Speaker', price: 12, owner: 'Dana W', image: 'https://images.unsplash.com/photo-1519121789249-bc1c1f1c7c93?auto=format&fit=crop&w=400&q=80' },
                    { title: 'GoPro Hero Action Camera', price: 20, owner: 'Mike T', image: 'https://images.unsplash.com/photo-1517841905240-472988babdf9?auto=format&fit=crop&w=400&q=80' },
                    { title: 'Cordless Power Drill Set', price: 10, owner: 'Lisa M', image: 'https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?auto=format&fit=crop&w=400&q=80' }
                ];
            }
            
            postsContainer.innerHTML = '';
            posts.forEach(post => {
                const postHtml = `
                    <div class="col">
                        <div class="card h-100" style="cursor: pointer;" onclick="window.location.href='product-details.html'">
                            <img src="${post.image}" class="card-img-top" alt="${post.title}" style="height: 200px; object-fit: cover;">
                            <div class="card-body">
                                <h5 class="card-title">${post.title}</h5>
                                <p class="card-text mb-1"><b>$${post.price}.00</b> <span class="text-muted">/ day</span></p>
                                <p class="card-text small">Owner: <a href="/user/1" class="text-decoration-none text-primary">${post.owner}</a></p>
                                <button class="btn btn-primary w-100" onclick="event.stopPropagation();">Book Now</button>
                            </div>
                        </div>
                    </div>
                `;
                postsContainer.innerHTML += postHtml;
            });
        }

        // Init
        const category = getQueryParam('category');
        renderHeader(category);
        updateHeroTitle(category);
        if (category) {
            renderSubcategories(category);
            renderFeaturedCarousel(category);
            renderSamplePosts(category);
        } else {
            // Show default posts and featured items for all categories
            renderSamplePosts();
            renderFeaturedCarousel('tools'); // Default featured items
        }
        
        // Initialize filter modal functionality
        initializeFilters();
    })();
    
    // Filter Modal Functions
    function initializeFilters() {
        const mainCategory = document.getElementById('mainCategory');
        const subcategory = document.getElementById('subcategory');
        
        // Update subcategories when main category changes
        mainCategory.addEventListener('change', function() {
            updateSubcategoryOptions(this.value);
        });
        
        // Set initial category if present in URL
        const urlCategory = getQueryParam('category');
        if (urlCategory) {
            mainCategory.value = urlCategory;
            updateSubcategoryOptions(urlCategory);
        }
    }
    
    function updateSubcategoryOptions(category) {
        const subcategory = document.getElementById('subcategory');
        subcategory.innerHTML = '<option value="">All Subcategories</option>';
        
        if (category && subcategories[category]) {
            subcategories[category].forEach(sub => {
                const option = document.createElement('option');
                option.value = sub;
                option.textContent = sub;
                subcategory.appendChild(option);
            });
        }
    }
    
    function applyFilters() {
        const filters = {
            category: document.getElementById('mainCategory').value,
            subcategory: document.getElementById('subcategory').value,
            minPrice: document.getElementById('minPrice').value,
            maxPrice: document.getElementById('maxPrice').value,
            location: document.getElementById('location').value,
            distance: document.getElementById('distance').value,
            startDate: document.getElementById('startDate').value,
            endDate: document.getElementById('endDate').value,
            rating: document.querySelector('input[name="rating"]:checked').value,
            sortBy: document.getElementById('sortBy').value,
            verifiedOwners: document.getElementById('verifiedOwners').checked,
            instantBooking: document.getElementById('instantBooking').checked,
            freeDelivery: document.getElementById('freeDelivery').checked,
            weekendOnly: document.getElementById('weekendOnly').checked,
            longTerm: document.getElementById('longTerm').checked,
            negotiable: document.getElementById('negotiable').checked
        };
        
        // Here you would typically send these filters to your backend
        console.log('Applied filters:', filters);
        
        // Update the results count (example)
        const resultsCount = document.querySelector('.mb-2.text-muted.small');
        if (resultsCount) {
            resultsCount.innerHTML = `Filtered results in the <b>Ottawa</b> area`;
        }
        
        // Close the modal
        const modal = bootstrap.Modal.getInstance(document.getElementById('filterModal'));
        modal.hide();
        
        // Show a success message
        showFilterAppliedMessage();
    }
    
    function clearFilters() {
        document.getElementById('filterForm').reset();
        updateSubcategoryOptions('');
        
        // Reset to default values
        document.getElementById('distance').value = '10';
        document.getElementById('sortBy').value = 'relevance';
        document.getElementById('ratingAny').checked = true;
        
        console.log('Filters cleared');
    }
    
    function showFilterAppliedMessage() {
        // Create a temporary success message
        const message = document.createElement('div');
        message.className = 'alert alert-success alert-dismissible fade show position-fixed';
        message.style.cssText = 'top: 20px; right: 20px; z-index: 9999;';
        message.innerHTML = `
            <i class="bi bi-check-circle me-2"></i>
            Filters applied successfully!
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        `;
        document.body.appendChild(message);
        
        // Remove the message after 3 seconds
        setTimeout(() => {
            if (message.parentNode) {
                message.remove();
            }
        }, 3000);
    }
    </script>

    <!-- Login Modal -->
    <div class="modal fade" id="loginModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Login to Your Account</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="mb-3">
                            <label for="loginEmail" class="form-label">Email address</label>
                            <input type="email" class="form-control" id="loginEmail" required>
                        </div>
                        <div class="mb-3">
                            <label for="loginPassword" class="form-label">Password</label>
                            <input type="password" class="form-control" id="loginPassword" required>
                        </div>
                        <div class="mb-3 form-check">
                            <input type="checkbox" class="form-check-input" id="rememberMe">
                            <label class="form-check-label" for="rememberMe">Remember me</label>
                        </div>
                        <button type="submit" class="btn auth-button w-100">Login</button>
                        <div class="text-center mt-3">
                            <a href="#" class="text-decoration-none">Forgot password?</a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div class="modal fade" id="registerModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Create an Account</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="mb-3">
                            <label for="registerFirstName" class="form-label">First Name</label>
                            <input type="text" class="form-control" id="registerFirstName" required>
                        </div>
                        <div class="mb-3">
                            <label for="registerLastName" class="form-label">Last Name</label>
                            <input type="text" class="form-control" id="registerLastName" required>
                        </div>
                        <div class="mb-3">
                            <label for="registerEmail" class="form-label">Email address</label>
                            <input type="email" class="form-control" id="registerEmail" required>
                        </div>
                        <div class="mb-3">
                            <label for="registerPhone" class="form-label">Phone Number</label>
                            <input type="tel" class="form-control" id="registerPhone" required>
                        </div>
                        <div class="mb-3">
                            <label for="registerPassword" class="form-label">Password</label>
                            <input type="password" class="form-control" id="registerPassword" required>
                        </div>
                        <div class="mb-3">
                            <label for="confirmPassword" class="form-label">Confirm Password</label>
                            <input type="password" class="form-control" id="confirmPassword" required>
                        </div>
                        <div class="mb-3 form-check">
                            <input type="checkbox" class="form-check-input" id="termsAgreement" required>
                            <label class="form-check-label" for="termsAgreement">
                                I agree to the <a href="#">Terms of Service</a> and <a href="#">Privacy Policy</a>
                            </label>
                        </div>
                        <button type="submit" class="btn auth-button w-100">Create Account</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Listing Modal -->
    <div class="modal fade" id="createListingModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Create a New Listing</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="row">
                            <div class="col-md-8">
                                <div class="mb-3">
                                    <label for="itemTitle" class="form-label">Item Title</label>
                                    <input type="text" class="form-control" id="itemTitle" placeholder="e.g., Professional Camera Kit" required>
                                </div>
                                <div class="mb-3">
                                    <label for="itemDescription" class="form-label">Description</label>
                                    <textarea class="form-control" id="itemDescription" rows="4" placeholder="Describe your item, its condition, and what's included..." required></textarea>
                                </div>
                                
                                <!-- Upload Images Section -->
                                <div class="mb-3">
                                    <label for="itemImages" class="form-label">Upload Images</label>
                                    <div class="border rounded p-3 text-center" style="border-style: dashed !important;">
                                        <i class="bi bi-cloud-upload fs-1 text-muted"></i>
                                        <p class="mt-2 mb-0">Drag and drop images here or click to browse</p>
                                        <input type="file" class="form-control mt-2" id="itemImages" multiple accept="image/*">
                                    </div>
                                </div>
                                
                                <!-- Categories Section -->
                                <div class="mb-3">
                                    <label class="form-label">Categories</label>
                                    <div class="mb-2">
                                        <small class="text-muted fw-medium">Click to select/deselect categories that best describe your item</small>
                                    </div>
                                    <div class="categories-container border rounded p-3" style="max-height: 300px; overflow-y: auto;">
                                        <div class="row g-2">
                                            <div class="col-md-6">
                                                <button type="button" class="btn btn-outline-primary category-btn w-100 mb-2" data-category="tools">
                                                    <i class="bi bi-tools me-1"></i>Tools & Equipment
                                                </button>
                                                <button type="button" class="btn btn-outline-primary category-btn w-100 mb-2" data-category="sports">
                                                    <i class="bi bi-bicycle me-1"></i>Sports & Outdoors
                                                </button>
                                                <button type="button" class="btn btn-outline-primary category-btn w-100 mb-2" data-category="electronics">
                                                    <i class="bi bi-camera me-1"></i>Electronics
                                                </button>
                                                <button type="button" class="btn btn-outline-primary category-btn w-100 mb-2" data-category="entertainment">
                                                    <i class="bi bi-controller me-1"></i>Entertainment
                                                </button>
                                                <button type="button" class="btn btn-outline-primary category-btn w-100 mb-2" data-category="home">
                                                    <i class="bi bi-house me-1"></i>Home & Garden
                                                </button>
                                                <button type="button" class="btn btn-outline-primary category-btn w-100 mb-2" data-category="vehicles">
                                                    <i class="bi bi-car-front me-1"></i>Vehicles & Transportation
                                                </button>
                                                <button type="button" class="btn btn-outline-primary category-btn w-100 mb-2" data-category="fashion">
                                                    <i class="bi bi-bag me-1"></i>Fashion & Accessories
                                                </button>
                                                <button type="button" class="btn btn-outline-primary category-btn w-100 mb-2" data-category="baby">
                                                    <i class="bi bi-heart me-1"></i>Baby & Kids
                                                </button>
                                                <button type="button" class="btn btn-outline-primary category-btn w-100 mb-2" data-category="business">
                                                    <i class="bi bi-briefcase me-1"></i>Business & Office
                                                </button>
                                                <button type="button" class="btn btn-outline-primary category-btn w-100 mb-2" data-category="health">
                                                    <i class="bi bi-activity me-1"></i>Health & Fitness
                                                </button>
                                                <button type="button" class="btn btn-outline-primary category-btn w-100 mb-2" data-category="photography">
                                                    <i class="bi bi-camera-video me-1"></i>Photography & Video
                                                </button>
                                                <button type="button" class="btn btn-outline-primary category-btn w-100 mb-2" data-category="music">
                                                    <i class="bi bi-music-note me-1"></i>Music & Audio
                                                </button>
                                            </div>
                                            <div class="col-md-6">
                                                <button type="button" class="btn btn-outline-primary category-btn w-100 mb-2" data-category="party">
                                                    <i class="bi bi-cup-hot me-1"></i>Party & Events
                                                </button>
                                                <button type="button" class="btn btn-outline-primary category-btn w-100 mb-2" data-category="outdoor">
                                                    <i class="bi bi-tree me-1"></i>Outdoor & Camping
                                                </button>
                                                <button type="button" class="btn btn-outline-primary category-btn w-100 mb-2" data-category="fitness">
                                                    <i class="bi bi-heart-pulse me-1"></i>Fitness Equipment
                                                </button>
                                                <button type="button" class="btn btn-outline-primary category-btn w-100 mb-2" data-category="gaming">
                                                    <i class="bi bi-joystick me-1"></i>Gaming & VR
                                                </button>
                                                <button type="button" class="btn btn-outline-primary category-btn w-100 mb-2" data-category="audio">
                                                    <i class="bi bi-speaker me-1"></i>Audio & Sound
                                                </button>
                                                <button type="button" class="btn btn-outline-primary category-btn w-100 mb-2" data-category="lighting">
                                                    <i class="bi bi-lightbulb me-1"></i>Lighting & Decor
                                                </button>
                                                <button type="button" class="btn btn-outline-primary category-btn w-100 mb-2" data-category="kitchen">
                                                    <i class="bi bi-cup-straw me-1"></i>Kitchen & Appliances
                                                </button>
                                                <button type="button" class="btn btn-outline-primary category-btn w-100 mb-2" data-category="crafts">
                                                    <i class="bi bi-palette me-1"></i>Crafts & Hobbies
                                                </button>
                                                <button type="button" class="btn btn-outline-primary category-btn w-100 mb-2" data-category="pet">
                                                    <i class="bi bi-heart me-1"></i>Pet Supplies
                                                </button>
                                                <button type="button" class="btn btn-outline-primary category-btn w-100 mb-2" data-category="automotive">
                                                    <i class="bi bi-wrench me-1"></i>Automotive Tools
                                                </button>
                                                <button type="button" class="btn btn-outline-primary category-btn w-100 mb-2" data-category="musical">
                                                    <i class="bi bi-music-note-beamed me-1"></i>Musical Instruments
                                                </button>
                                                <button type="button" class="btn btn-outline-primary category-btn w-100 mb-2" data-category="other">
                                                    <i class="bi bi-three-dots me-1"></i>Other
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Availability Section -->
                                <div class="mb-3">
                                    <label class="form-label">Availability</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="availableNow" checked>
                                        <label class="form-check-label" for="availableNow">
                                            Available now
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="availableWeekends">
                                        <label class="form-check-label" for="availableWeekends">
                                            Available weekends
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="location" class="form-label">Location</label>
                                            <input type="text" class="form-control" id="location" placeholder="City, Province" required>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="contactPhone" class="form-label">Contact Phone</label>
                                            <input type="tel" class="form-control" id="contactPhone" required>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Daily Rate Section -->
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="dailyRate" class="form-label">Daily Rate ($)</label>
                                            <input type="number" class="form-control" id="dailyRate" min="1" step="0.01" required>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Booking System Section -->
                                <div class="booking-section mt-4">
                                    <h6 class="mb-3">Booking Settings</h6>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="minRentalDays" class="form-label">Minimum Rental Days</label>
                                                <input type="number" class="form-control" id="minRentalDays" min="1" value="1">
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="maxRentalDays" class="form-label">Maximum Rental Days</label>
                                                <input type="number" class="form-control" id="maxRentalDays" min="1" value="30">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="advanceBookingDays" class="form-label">Advance Booking (days)</label>
                                                <input type="number" class="form-control" id="advanceBookingDays" min="0" value="7">
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="cancellationPolicy" class="form-label">Cancellation Policy</label>
                                                <select class="form-select" id="cancellationPolicy">
                                                    <option value="flexible">Flexible (24h notice)</option>
                                                    <option value="moderate">Moderate (48h notice)</option>
                                                    <option value="strict">Strict (7 days notice)</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <!-- Calendar Section -->
                                <div class="calendar-section mt-4">
                                    <h6 class="mb-3">Availability Calendar</h6>
                                    <div class="calendar-container">
                                        <div class="calendar-header d-flex justify-content-between align-items-center mb-3">
                                            <button type="button" class="btn btn-sm btn-outline-secondary" id="prevMonth">
                                                <i class="bi bi-chevron-left"></i>
                                            </button>
                                            <h6 class="mb-0" id="currentMonth">December 2024</h6>
                                            <button type="button" class="btn btn-sm btn-outline-secondary" id="nextMonth">
                                                <i class="bi bi-chevron-right"></i>
                                            </button>
                                        </div>
                                        <div class="calendar-weekdays d-flex">
                                            <div class="calendar-weekday">Sun</div>
                                            <div class="calendar-weekday">Mon</div>
                                            <div class="calendar-weekday">Tue</div>
                                            <div class="calendar-weekday">Wed</div>
                                            <div class="calendar-weekday">Thu</div>
                                            <div class="calendar-weekday">Fri</div>
                                            <div class="calendar-weekday">Sat</div>
                                        </div>
                                        <div class="calendar-days" id="calendarDays">
                                            <!-- Calendar days will be populated by JavaScript -->
                                        </div>
                                    </div>
                                    <div class="calendar-legend mt-3">
                                        <div class="d-flex align-items-center mb-2">
                                            <div class="legend-item available"></div>
                                            <small class="ms-2">Available</small>
                                        </div>
                                        <div class="d-flex align-items-center mb-2">
                                            <div class="legend-item unavailable"></div>
                                            <small class="ms-2">Unavailable</small>
                                        </div>
                                        <div class="d-flex align-items-center">
                                            <div class="legend-item selected"></div>
                                            <small class="ms-2">Selected</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="d-flex justify-content-end gap-2">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="submit" class="btn auth-button">Create Listing</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="location-service.js"></script>
    
    <!-- Calendar and Booking System JavaScript -->
    <script>
        class RentalCalendar {
            constructor() {
                this.currentDate = new Date();
                this.selectedDates = new Set();
                this.unavailableDates = new Set();
                this.init();
            }

            init() {
                this.renderCalendar();
                this.bindEvents();
                this.setupBookingSettings();
            }

            renderCalendar() {
                const year = this.currentDate.getFullYear();
                const month = this.currentDate.getMonth();
                
                // Update month/year display
                const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                                  'July', 'August', 'September', 'October', 'November', 'December'];
                document.getElementById('currentMonth').textContent = `${monthNames[month]} ${year}`;

                // Get first day of month and number of days
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const startDate = new Date(firstDay);
                startDate.setDate(startDate.getDate() - firstDay.getDay());

                const calendarDays = document.getElementById('calendarDays');
                calendarDays.innerHTML = '';

                // Generate calendar days
                for (let i = 0; i < 42; i++) {
                    const date = new Date(startDate);
                    date.setDate(startDate.getDate() + i);
                    
                    const dayElement = document.createElement('div');
                    dayElement.className = 'calendar-day';
                    dayElement.textContent = date.getDate();
                    dayElement.dataset.date = date.toISOString().split('T')[0];

                    // Check if it's current month
                    if (date.getMonth() !== month) {
                        dayElement.classList.add('other-month');
                    }

                    // Check if it's today
                    const today = new Date();
                    if (date.toDateString() === today.toDateString()) {
                        dayElement.classList.add('today');
                    }

                    // Check availability
                    if (this.unavailableDates.has(date.toISOString().split('T')[0])) {
                        dayElement.classList.add('unavailable');
                    } else if (date.getMonth() === month) {
                        dayElement.classList.add('available');
                    }

                    // Check if selected
                    if (this.selectedDates.has(date.toISOString().split('T')[0])) {
                        dayElement.classList.add('selected');
                    }

                    calendarDays.appendChild(dayElement);
                }
            }

            bindEvents() {
                // Month navigation
                document.getElementById('prevMonth').addEventListener('click', () => {
                    this.currentDate.setMonth(this.currentDate.getMonth() - 1);
                    this.renderCalendar();
                });

                document.getElementById('nextMonth').addEventListener('click', () => {
                    this.currentDate.setMonth(this.currentDate.getMonth() + 1);
                    this.renderCalendar();
                });

                // Day selection
                document.getElementById('calendarDays').addEventListener('click', (e) => {
                    if (e.target.classList.contains('calendar-day') && 
                        !e.target.classList.contains('other-month') && 
                        !e.target.classList.contains('unavailable')) {
                        
                        const date = e.target.dataset.date;
                        this.toggleDateSelection(date);
                        this.renderCalendar();
                    }
                });

                // Booking settings changes
                document.getElementById('minRentalDays').addEventListener('change', () => {
                    this.updateAvailability();
                });

                document.getElementById('maxRentalDays').addEventListener('change', () => {
                    this.updateAvailability();
                });

                document.getElementById('advanceBookingDays').addEventListener('change', () => {
                    this.updateAvailability();
                });
            }

            toggleDateSelection(date) {
                if (this.selectedDates.has(date)) {
                    this.selectedDates.delete(date);
                } else {
                    this.selectedDates.add(date);
                }
            }

            setupBookingSettings() {
                // Set some example unavailable dates (weekends for demo)
                const today = new Date();
                for (let i = 0; i < 90; i++) {
                    const date = new Date(today);
                    date.setDate(today.getDate() + i);
                    
                    // Make some weekends unavailable for demo
                    if (date.getDay() === 0 || date.getDay() === 6) {
                        this.unavailableDates.add(date.toISOString().split('T')[0]);
                    }
                }
                this.updateAvailability();
            }

            updateAvailability() {
                const minDays = parseInt(document.getElementById('minRentalDays').value) || 1;
                const maxDays = parseInt(document.getElementById('maxRentalDays').value) || 30;
                const advanceDays = parseInt(document.getElementById('advanceBookingDays').value) || 7;

                const today = new Date();
                const advanceDate = new Date(today);
                advanceDate.setDate(today.getDate() + advanceDays);

                // Clear previous availability
                this.unavailableDates.clear();

                // Set advance booking restriction
                for (let i = 0; i < advanceDays; i++) {
                    const date = new Date(today);
                    date.setDate(today.getDate() + i);
                    this.unavailableDates.add(date.toISOString().split('T')[0]);
                }

                // Set some example unavailable dates (weekends for demo)
                for (let i = advanceDays; i < 90; i++) {
                    const date = new Date(today);
                    date.setDate(today.getDate() + i);
                    
                    // Make some weekends unavailable for demo
                    if (date.getDay() === 0 || date.getDay() === 6) {
                        this.unavailableDates.add(date.toISOString().split('T')[0]);
                    }
                }

                this.renderCalendar();
            }

            getSelectedDates() {
                return Array.from(this.selectedDates).sort();
            }

            getBookingData() {
                return {
                    selectedDates: this.getSelectedDates(),
                    minRentalDays: parseInt(document.getElementById('minRentalDays').value) || 1,
                    maxRentalDays: parseInt(document.getElementById('maxRentalDays').value) || 30,
                    advanceBookingDays: parseInt(document.getElementById('advanceBookingDays').value) || 7,
                    cancellationPolicy: document.getElementById('cancellationPolicy').value
                };
            }
        }

        // Initialize calendar when modal is shown
        let rentalCalendar;
        document.getElementById('createListingModal').addEventListener('shown.bs.modal', function () {
            if (!rentalCalendar) {
                rentalCalendar = new RentalCalendar();
            }
        });

        // Handle form submission
        document.querySelector('#createListingModal form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get selected categories
            const selectedCategories = [];
            const categoryButtons = document.querySelectorAll('.category-btn');
            categoryButtons.forEach(button => {
                if (button.classList.contains('btn-primary')) {
                    selectedCategories.push(button.dataset.category);
                }
            });
            
            // Validate that at least one category is selected
            if (selectedCategories.length === 0) {
                alert('Please select at least one category for your item.');
                return;
            }
            
            if (rentalCalendar) {
                const bookingData = rentalCalendar.getBookingData();
                const formData = {
                    title: document.getElementById('itemTitle').value,
                    description: document.getElementById('itemDescription').value,
                    categories: selectedCategories,
                    dailyRate: document.getElementById('dailyRate').value,
                    location: document.getElementById('location').value,
                    contactPhone: document.getElementById('contactPhone').value,
                    bookingData: bookingData
                };
                
                console.log('Form Data:', formData);
                console.log('Selected Categories:', selectedCategories);
                
                // Here you would typically send the data to your backend
                alert(`Listing created successfully! Categories: ${selectedCategories.join(', ')}`);
                
                // Close modal
                const modal = bootstrap.Modal.getInstance(document.getElementById('createListingModal'));
                modal.hide();
            }
        });

        // Add some interactive features
        document.addEventListener('DOMContentLoaded', function() {
            // Auto-populate some fields for demo
            document.getElementById('itemTitle').addEventListener('focus', function() {
                if (!this.value) {
                    this.placeholder = 'e.g., Professional Camera Kit, Mountain Bike, Power Tools';
                }
            });

            // Show booking preview
            document.getElementById('dailyRate').addEventListener('input', function() {
                const rate = parseFloat(this.value) || 0;
                const minDays = parseInt(document.getElementById('minRentalDays').value) || 1;
                const maxDays = parseInt(document.getElementById('maxRentalDays').value) || 30;
                
                if (rate > 0) {
                    const minTotal = (rate * minDays).toFixed(2);
                    const maxTotal = (rate * maxDays).toFixed(2);
                    
                    // You could display this information somewhere in the UI
                    console.log(`Rental range: $${minTotal} - $${maxTotal}`);
                }
            });

            // Add category button functionality
            const categoryButtons = document.querySelectorAll('.category-btn');
            categoryButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // Toggle button state
                    if (this.classList.contains('btn-outline-primary')) {
                        this.classList.remove('btn-outline-primary');
                        this.classList.add('btn-primary');
                    } else {
                        this.classList.remove('btn-primary');
                        this.classList.add('btn-outline-primary');
                    }
                    
                    // Update visual feedback
                    updateCategorySelectionFeedback();
                });
            });

            // Add "Select All" and "Clear All" functionality
            const categoriesContainer = document.querySelector('.categories-container');
            if (categoriesContainer) {
                const selectAllBtn = document.createElement('button');
                selectAllBtn.type = 'button';
                selectAllBtn.className = 'btn btn-sm btn-outline-primary me-2';
                selectAllBtn.textContent = 'Select All';
                selectAllBtn.addEventListener('click', function() {
                    categoryButtons.forEach(button => {
                        button.classList.remove('btn-outline-primary');
                        button.classList.add('btn-primary');
                    });
                    updateCategorySelectionFeedback();
                });

                const clearAllBtn = document.createElement('button');
                clearAllBtn.type = 'button';
                clearAllBtn.className = 'btn btn-sm btn-outline-secondary';
                clearAllBtn.textContent = 'Clear All';
                clearAllBtn.addEventListener('click', function() {
                    categoryButtons.forEach(button => {
                        button.classList.remove('btn-primary');
                        button.classList.add('btn-outline-primary');
                    });
                    updateCategorySelectionFeedback();
                });

                // Insert buttons before the categories container
                const label = categoriesContainer.previousElementSibling;
                const buttonContainer = document.createElement('div');
                buttonContainer.className = 'mb-2';
                buttonContainer.appendChild(selectAllBtn);
                buttonContainer.appendChild(clearAllBtn);
                label.parentNode.insertBefore(buttonContainer, label.nextSibling);
            }

            // Function to update visual feedback
            function updateCategorySelectionFeedback() {
                const selectedCategories = [];
                categoryButtons.forEach(button => {
                    if (button.classList.contains('btn-primary')) {
                        selectedCategories.push(button.dataset.category);
                    }
                });
                
                // Update visual feedback
                const container = document.querySelector('.categories-container');
                if (selectedCategories.length > 0) {
                    container.style.borderColor = '#198754'; // Green border when categories selected
                    container.style.backgroundColor = '#f8fff9';
                } else {
                    container.style.borderColor = '#dee2e6'; // Default border
                    container.style.backgroundColor = 'transparent';
                }
                
                console.log('Selected categories:', selectedCategories);
            }
        });
    </script>
</body>
</html> 